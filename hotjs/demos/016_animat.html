<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="Expires" CONTENT="0">
<meta http-equiv="Cache-Control" CONTENT="no-cache">
<meta http-equiv="Pragma" CONTENT="no-cache">
<meta name="viewport"
	content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
<script src="../hotjs.js"></script>
<script src="../math.js"></script>
<script src="../resource.js"></script>
<script src="../canvas.js"></script>
<script src="../sprite.js"></script>
<style type="text/css">
html, body {
	width: 100%;
	height: 100%;
	overflow: hidden;
	margin: 0;
	padding: 0;
}
div#buttons {
	position: absolute;
	right: 20px;
	top: 20px;
}
input {
	position: absolute;
	right: 0px;
}
</style>
</head>
<body>
<div id="viewX" style="display: inline-block; margin: 0px;"></div>
<div id="buttons">
</div>
<script>

var WalkingRoom = function(){
	hotjs.base(this);
}

hotjs.inherit(WalkingRoom, hotjs.Scene,{
	update : function(dt) {
		WalkingRoom.supClass.update.call(this, dt);
		
		for( var i = this.subnodes.length-1; i >= 0; i -- ) {
			var b = this.subnodes[i];
			if( b.pos[0] < 0 - b.size[0] ) {
				b.pos[0] = this.width();
			}
		}
	}
});

function main(){
	var w = window.innerWidth, h = window.innerHeight;

	var v = document.getElementById('viewX');
	v.style.width = w;
	v.style.height = h;

	var viewX = (new hotjs.View())
		.setContainer('viewX')
		.setSize(w,h)
		.setFps( 25 )
		.showFPS(true);

	var room = (new hotjs.Scene())
		.setSize(w,h)
		.setColor("blue").showGrid(false)
		.setBgColor('white')
		.addTo(viewX,'hello');

	var x = 200, y = 100;
	var anims = sprites['yeti.sprite.js']['anims'];
	for( var i in anims ) {
		monster = (new hotjs.Node())
			.setSprite( new hotjs.Animat('img/yeti.sprite.js', i) )
			.setPos( x, y )
			//.setPos( room.width()/2, room.height()/2 )
			.addTo( room );
		
		x += 150;
		if( x+100 > room.width() ) {
			x = 200;
			y += 150;
		}		
	}
	
	var anims = sprites['BING_male.sprite.js']['anims'];
	for( var i in anims ) {
		npc = (new hotjs.Node())
			.setSprite( new hotjs.Animat('img/BING_male.sprite.js', i) )
			.setPos( x, y )
			//.setPos( room.width()/2, room.height()/2 )
			.addTo( room );
		
		x += 150;
		if( x+100 > room.width() ) {
			x = 200;
			y += 150;
		}
	}

	var app = (new hotjs.App()).addNode( viewX ).start();
}

resources.load([
                'img/yeti.sprite.js',
                'img/BING_male.sprite.js'
                ], { ready: main });

</script>
</body>

</html>
